<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Nikola (getnikola.com)">
<title>几个有用的终端命令整理 - MacPlay</title>
<link href="../../assets/css/semantic.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/jquery.fancybox.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="canonical" href="https://macplay.github.io/posts/ji-ge-you-yong-de-zhong-duan-ming-ling-zheng-li/">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<meta name="author" content="ashfinal">
<meta property="og:site_name" content="MacPlay">
<meta property="og:title" content="几个有用的终端命令整理">
<meta property="og:url" content="https://macplay.github.io/posts/ji-ge-you-yong-de-zhong-duan-ming-ling-zheng-li/">
<meta property="og:description" content="使用 zsh 之后，就养成了不整理终端命令的“坏”习惯。可能当时遇到问题折腾好半天才解决，但却从没有写个日志（哪怕片段）记录下来的想法。因为 zsh 默认保存上万条历史记录让这一想法显得没有必要，要再次调用的话直接 fzf 搜索，简单修改下回车执行就行。
最近两天抹盘安装了 High Sierra 系统，装完后把之前的 .zsh_history 文件拷贝回 home 目录，保持“坏”习惯继续接着用">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-09-28T21:47:01+08:00">
<link rel="stylesheet" href="../../assets/css/gitalk.css">
</head>
<body>
            <header id="header"><div class="ui grid">
            <div class="computer only tablet only three wide column">
            </div>
            <div class="computer only tablet only ten wide column">
                <div class="ui huge secondary stackable menu">
                    <a class="header item brand-logo" href="https://macplay.github.io/">
                        MacPlay
                    </a>
                            <a class="item" href="../../">Posts</a>
                            <a class="item" href="../../listings/">Code</a>
                            <a class="item" href="../../galleries/">Gallery</a>
                            <a class="item" href="../../categories/">Tags</a>
                            <a class="item" href="../../archive.html">Archive</a>
                    <div class="right menu">
                        <a class="item" href="../../rss.xml"><i class="rss icon"></i>RSS</a>
                    </div>
                </div>
            </div>
            <div class="mobile only sixteen wide column">
                <div class="ui fluid accordion vertical menu">
                    <div class="item">
                        <a class="title">MacPlay</a>
                        <div class="content">
                                    <a class="item" href="../../">Posts</a>
                                    <a class="item" href="../../listings/">Code</a>
                                    <a class="item" href="../../galleries/">Gallery</a>
                                    <a class="item" href="../../categories/">Tags</a>
                                    <a class="item" href="../../archive.html">Archive</a>
                            <a class="item" href="../../rss.xml"><i class="rss icon"></i>RSS</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="computer only tablet only three wide column">
            </div>
        </div>

    </header><main id="main"><div class="ui grid">
                <div class="three wide computer three wide tablet column">
                    <div id="left-side">
                    </div>
                </div>
                <div class="ten wide computer ten wide tablet sixteen wide mobile column">
                    <div class="mobile only sixteen wide column">
                        <div id="main-content">
<div class="postpage post-text page-body" itemscope="itemscope" itemtype="http://schema.org/Article">
            <h1 class="post-title" itemprop="headline">
        <a href=".">几个有用的终端命令整理</a>
    </h1>

    <div class="post-meta">
        <span class="post-meta-item-icon">
            <i class="user icon"></i>
        </span>
        <span class="post-meta-item-text" itemprop="author">
            <a href="../../authors/ashfinal/">ashfinal</a>
        </span>
        <span class="post-meta-divider">|</span>
        <span class="post-meta-item-icon">
            <i class="calendar icon"></i>
        </span>
        <span class="post-meta-item-text">
            <a href="../../archive.html">
                <time datetime="2017-09-28T21:47:01+08:00" itemprop="datePublished" title="2017-09-28 21:47">2017-09-28 21:47
                </time></a>
        </span>
    </div>

    
    <div class="post-content" itemprop="article text">
        <div class="ui sticky" id="edit-btn">
            <a class="ui white right ribbon label" href="https://github.com/macplay/macplay.github.io/edit/src/posts/ji-ge-you-yong-de-zhong-duan-ming-ling-zheng-li.rst" title="Edit on GitHub">Edit</a>
        </div>
        <div id="post-content">
        <div>
<p>使用 zsh 之后，就养成了不整理终端命令的“坏”习惯。可能当时遇到问题折腾好半天才解决，但却从没有写个日志（哪怕片段）记录下来的想法。因为 zsh 默认保存上万条历史记录让这一想法显得没有必要，要再次调用的话直接 fzf 搜索，简单修改下回车执行就行。</p>
<p>最近两天抹盘安装了 High Sierra 系统，装完后把之前的 <cite>.zsh_history</cite> 文件拷贝回 home 目录，保持“坏”习惯继续接着用就成。不过还是有点不放心，一方面担心使用频率超低（但有用）的命令可能会被冲掉，另一方面万一某一天 history 文件损坏就悲剧了，另外有时也会有到别的电脑上执行命令的需求。所以，还是整理下为好，该命令列表应该会不定期更新。</p>
<!-- TEASER_END -->
<ol class="arabic">
<li>
<p class="first">查找并删除 <cite>.DS_Store</cite> 文件</p>
<p><cite>find . -type f -name ".DS_Store" -delete</cite></p>
<p><cite>.DS_Store</cite> 文件有时会引起些小麻烦，用以上命令清掉就好。 <cite>.DS_Store</cite> 只是举个例子，文件名称可以随便填，可用通配符。还有 <cite>-depth 1</cite> 可用来指定递归深度，比如删除掉 <cite>Downloads</cite> 目录最外面一层所有的 <cite>jpg</cite> 图片。</p>
</li>
<li>
<p class="first">find 也可以用正则表达式</p>
<p>当然只是有限的正则表达式。比如把符合条件的所有图片移动到桌面。</p>
<p><tt class="docutils literal">find . <span class="pre">-regex</span> <span class="pre">".*/[a-z0-9]\{32\}\.jpg"</span> <span class="pre">-exec</span> mv {} ~/Desktop/ \;</tt></p>
</li>
<li>
<p class="first">分别统计文件行数</p>
<p><cite>find ~/.hammerspoon -type f -name "*.lua" -print0 | xargs -0 wc -l</cite></p>
</li>
<li>
<p class="first">配合 chmod 使用</p>
<p><tt class="docutils literal">find . <span class="pre">-type</span> f <span class="pre">-exec</span> chmod 644 {} \;</tt></p>
<p><tt class="docutils literal">find . <span class="pre">-type</span> d <span class="pre">-exec</span> chmod 744 {} \;</tt></p>
<p>最近的 find 应用案例。把移动硬盘上备份的 repo 复制回新安装的系统，结果提示一大堆文件已更改，真是莫名其妙。<cite>git diff</cite> 一看，文件权限全变成了 755。这才想起老早老早以前把移动硬盘格成了 exFAT 格式，文件权限全丢了。利用以上两行命令，文件全改成 644，文件夹全改成 744，搞完后 repo 恢复正常。</p>
</li>
<li>
<p class="first">推出所有 dmg 磁盘</p>
<p><cite>osascript -e 'tell application "Finder" to eject (every disk whose ejectable is true)'</cite></p>
<p>有时候尝试完一堆新软件，懒得一个个点推出。执行一下这个就好。见过别人电脑上差不多 10 个未推出的 dmg 镜像，问干嘛用完不推呢，答曰刚使用 macOS 没这习惯……</p>
</li>
<li>
<p class="first">重置 LaunchPad</p>
<p><cite>defaults write com.apple.dock ResetLaunchPad -bool true; killall Dock</cite></p>
<p>如果你习惯让系统内置应用单独一页，同时不想让应用没布满一页就挤到下一页。执行该命令非常有效。</p>
</li>
<li>
<p class="first">重置 QuickLook 服务</p>
<p><cite>qlmanage -r</cite></p>
<p>QuickLook 就是按空格预览的那个东东。如果你复制了新的预览器（如 markdown、压缩包等）到 <cite>~/Library/QuickLook</cite> 目录，可能需要执行下该命令。</p>
</li>
<li>
<p class="first">加载新服务</p>
<p><cite>launchctl load -w ~/Library/LaunchAgents/com.github.aria2.plist</cite></p>
<p>让 aria2 开机后台运行，launchctl 常用命令还有 start、stop 等。</p>
</li>
<li>
<p class="first">指定内核启动 jupyter</p>
<p><cite>jupyter-qtconsole --kernel=python2</cite></p>
<p>jupyter console 和 Qt 前端均可用该方式指定启动时的内核。有了 jupyter console ， ipython 以后减少使用为好。 <cite>jupyter-kernelspec list</cite> 列出当前可用的内核。</p>
</li>
<li>
<p class="first">升级系统 vim</p>
<p><cite>brew install vim --with-override-system-vi --with-lua</cite></p>
<p>High Sierra 自带 vim 版本已经是 8.0，但编译缺了三个重要特性：clipboard、conceal、lua。用以上命令重新编译个倒也不费劲，时间还很快。不过，更好的选择是直接用 neovim 。</p>
</li>
<li>
<p class="first">neovim 配置位置</p>
<p><cite>~/.config/nvim/init.vim</cite> 。我的 vim 配置和 neovim 是共用的，所以执行下 <cite>ln ~/.vimrc ~/.config/nvim/init.vim</cite> 就好。</p>
</li>
<li>
<p class="first">给 neovim 添加 python 支持</p>
<p><cite>pip3 install neovim</cite></p>
<p>运行 <cite>:CheckHealth</cite> 可显示 neovim 的状态信息，包括 python2、python3 支持等。如果你使用 pyenv 或 virtualenv 的话，将 <cite>g:python_host_prog</cite> 或 <cite>g:python3_host_prog</cite> 的值设置为虚拟环境中 python 的执行路径。</p>
</li>
<li>
<p class="first">reST 转换为其它格式</p>
<p><cite>rst2s5.py ./posts/30-fen-zhong-jian-li-yi-ge-nikola-bo-ke.rst new.html</cite></p>
<p>还有其它类似命令： <cite>rst2html5.py</cite> ， <cite>rst2xelex.py</cite> ， <cite>rst2odt.py</cite> 等。</p>
</li>
<li>
<p class="first">you-get 下载视频</p>
<p><cite>you-get -i url</cite> 列出可用的视频下载格式； <cite>you-get --format=HD -p mpv url</cite> 指定下载格式，并调用 mpv 播放。</p>
</li>
<li>
<p class="first">统计文件夹大小</p>
<p><cite>du -d1 -h .vim</cite></p>
<p><cite>-d1</cite> 用来指定文件夹层次。</p>
</li>
</ol>
</div>
        </div>
    </div>
        <div class="post-navigation">
        <div class=" ui huge secondary stackable menu">
            <a class="post-nav-item post-nav-previous item" href="../old-man-smoked-his-pipe/" title="Previous post"><i class="angle double left icon"></i> Old Man Smoked His Pipe</a>
        </div>
    </div>

        <div id="gitalk-container" class="comments-block"></div>
</div>
                        </div>
                    </div>
                </div>
                <div class="three wide computer three wide tablet column">
                    <div id="right-side">
                    </div>
                </div>
            </div>
        </main><div class="ui grid">
        <div class="computer only tablet only three wide column">
        </div>
        <div class="computer only tablet only ten wide column">
            <div class="ui basic center aligned segment">Contents © 2017         <a href="mailto:ashfinal@sina.cn">ashfinal</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </div>
        </div>
        <div class="mobile only sixteen wide column">
            <div class="ui basic center aligned segment">Contents © 2017         <a href="mailto:ashfinal@sina.cn">ashfinal</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </div>
        </div>
        <div class="computer only tablet only three wide column">
        </div>
    </div>


        <script type="text/javascript" src="../../assets/js/jquery-3.2.1.min.js"></script><script type="text/javascript" src="../../assets/js/semantic.min.js"></script><script type="text/javascript" src="../../assets/js/jquery.fancybox.min.js"></script><script>
            $(document).ready(function(){
                $(".ui.dropdown").dropdown();
                $('.ui.accordion').accordion();
                $('.ui.nag').nag();
                $('.fancybox').fancybox();
            });
        </script><script src="../../assets/js/gitalk.min.js"></script><script>
        $(".ui.sticky").sticky({
            context: '#main',
        });
        const gitalk = new Gitalk({
            clientID: '12fcda845097d895a24c',
            clientSecret: '50ed60cde5f40897205197b4265b474cefbedc49',
            repo: 'macplay.github.io',
            owner: 'macplay',
            admin: ['macplay', 'ashfinal'],
            // facebook-like distraction free mode
            distractionFreeMode: false
        })
        gitalk.render('gitalk-container')
    </script>
</body>
</html>
